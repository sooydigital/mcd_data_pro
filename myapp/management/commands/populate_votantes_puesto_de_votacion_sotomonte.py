import time

from django.core.management.base import BaseCommand
from myapp.models import Votante, VotanteProfile, VotantePuestoVotacion, PuestoVotacion, VotanteMessage
from myapp.models import Barrio, Municipio, Departamento
from myapp.models import Etiqueta, EtiquetaVotante, CustomLink


VOTANTES = '''1095300546;SANTANDER;BUCARAMANGA;ORDEN DE LOS CLÉRIGOS REG SOMASCOS;CR 26 # 11N-30 BARRIO REGADERO NORTE;14
1095298730;SANTANDER;BUCARAMANGA;IE CAMPO HERMOSO;CR 9A OCC # 49-24 BARRIO CAMPO HERMOSO;5
1005371963;SANTANDER;BUCARAMANGA;ESC NORMAL SUPERIOR SEDE A;CLL 30 # 27-163 BARRIO AURORA;42
1005297219;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;4
1097489387;SANTANDER;BUCARAMANGA;I.E. LA JUVENTUD SEDE A;CLL 5 N # 19 A - 12 BARRIO LA JUVENTUD;6
1049290383;SANTANDER;BUCARAMANGA;GOBERNACION DE SANTANDER;CLL 37 No 10-36 BARRIO GARCIA ROVIRA;20
1097094120;SANTANDER;BUCARAMANGA;GOBERNACION DE SANTANDER;CLL 37 No 10-36 BARRIO GARCIA ROVIRA;21
1005258024;SANTANDER;BUCARAMANGA;IE NUESTRA SEÑORA DEL PILAR SEDE A;AV LOS ESTUDIANTES # 9-323 BARRIO REAL DE MINAS;15
1097489603;SANTANDER;BUCARAMANGA;COL SANTANDER SEDE A;CLL 9 # 25-67 BARRIO LA UNIVERSIDAD;38
1098793594;SANTANDER;BUCARAMANGA;ESC NORMAL SUPERIOR SEDE A;CLL 30 # 27-163 BARRIO AURORA;48
1098814718;SANTANDER;BUCARAMANGA;COL PSICOPEDAG CARL ROGERS;CR 25 # 31 - 94 BARRIO ANTONIA SANTOS;14
1098746289;SANTANDER;BUCARAMANGA;I.E. JOSE CELESTINO MUTIS;CR 3W # 57 - 14 BARRIO MUITS;41
1003249502;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;19
1005564698;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;39
1002459636;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;21
1014977651;SANTANDER;BUCARAMANGA;IE MAIPORÉ SEDE B;CLL 17N # 10-38 BARRIO KENNEDY;23
1005209613;SANTANDER;BUCARAMANGA;IE CENTRO PILOTO SIMON BOLIVAR;CR 20 # 11-83 - BARRIO MUTUALIDAD;18
1127582654;SANTANDER;BUCARAMANGA;IE LA LIBERTAD;CR 31 # 101 - 24 BARRIO LA LIBERTAD;19
1096062867;SANTANDER;BUCARAMANGA;I.E. NUESTRA SEÑORA DEL PILAR SEDE C;CLL 65 CR 11W ESQ BARRIO MONTERREDONDO;5
1193066889;ATLANTICO;BARRANQUILLA;IED LA CONCEPCION;CARRERA 70 No 77A-27;3
1048064918;SANTANDER;BUCARAMANGA;COL AURELIO MARTINEZ MUTIS SEDE A;AV LOS ESTUDIANTES # 9-313 BARRIO REAL DE MINAS;14
1091354382;NORTE DE SANTANDER;VILLA DEL ROSARIO;COLEGIO GENERAL SANTANDER;CL. 6 N¬∫ 8-14-CENTRO;20
1096700163;SANTANDER;BUCARAMANGA;COLEGIO LA PRESENTACION;CLE 56 # 33 - 38 BARRIO CABECERA DEL LLANO;14
1066866407;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;24
1096700141;SANTANDER;BUCARAMANGA;COLEGIO LA PRESENTACION;CLE 56 # 33 - 38 BARRIO CABECERA DEL LLANO;14
1097488944;SANTANDER;BUCARAMANGA;UNIDADES TECNOLOGICAS DE SANT;AV LOS ESTUDIANTES # 9-82 BARRIO REAL DE MINAS;27
1005258767;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;21
1059534200;SANTANDER;BUCARAMANGA;COL SANTANDER SEDE A;CLL 9 # 25-67 BARRIO LA UNIVERSIDAD;37
1098785803;SANTANDER;BUCARAMANGA;COLEGIO LA PRESENTACION;CLE 56 # 33 - 38 BARRIO CABECERA DEL LLANO;16
1099735284;SANTANDER;BUCARAMANGA;COL COOPERATIVO DE BUCARAMANGA;CLL 45 # 0-160 BARRIO CAMPO HERMOSO;32
1005336243;SANTANDER;BUCARAMANGA;ESC NORMAL SUPERIOR SEDE C;CLL 30 # 26 - 45 BARRIO ANTONIA SANTOS;12
1005329653;SANTANDER;BUCARAMANGA;IE NUESTRA SEÑORA DEL PILAR SEDE A;AV LOS ESTUDIANTES # 9-323 BARRIO REAL DE MINAS;16
91525969;SANTANDER;BUCARAMANGA;COL TEC EMPRESARIAL JOSE MARIA;CLL 51 #13-97 BARRIO SAN MIGUEL;9
91522156;SANTANDER;BUCARAMANGA;UNIVERSIDAD COOP DE COLOMBIA;CLL 30A # 33 - 51 BARRIO QUINTADANIA;27
1005136740;SANTANDER;BUCARAMANGA;I.E. SANTO ANGEL;CLL 9N # 18C - 04 BARRIO VILLA ROSA;3
1005258456;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;38
1098773421;SANTANDER;BUCARAMANGA;CEN DE SERVICIOS UNIVERSITARIOS CSU UNAB;CRA 47 N 53 78 BARRIO TERRAZAS;11
1098727482;SANTANDER;BUCARAMANGA;IE NUESTRA SEÑORA DEL PILAR SEDE A;AV LOS ESTUDIANTES # 9-323 BARRIO REAL DE MINAS;24
1098668496;SANTANDER;BUCARAMANGA;CENTRO VIDA KENNEDY;CRA 12 # 16N - 43 BARRIO KENNEDY;10
1098796978;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;40
1096216314;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;43
1007715183;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;23
1005336059;SANTANDER;BUCARAMANGA;I.E. JOSE CELESTINO MUTIS;CR 3W # 57 - 14 BARRIO MUITS;31
1099736031;SANTANDER;BUCARAMANGA;I.E. CLUB UNION SEDE A;CLE 3 A # 10 - 36 BARRIO SAN RAFAEL;5
1098759723;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;31
1096538463;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE A;CR 5 OCC # 30-61 BARRIO SANTANDER;6
1096538699;SANTANDER;GIRON;COLISEO CUBIERTO CIUDADELA VILLAMIL;DIAGONAL 16 PEATONAL #17 H-16 VILLAMIL;14
1005297607;SANTANDER;BUCARAMANGA;IE DÁMASO ZAPATA SEDE C;CLL 16N # 24-23 BARRIO VILLA HELENA;3
1098751058;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROVIRA SEDE G;CR 32 # 87 - 86 BARRIO SAN MARTIN;7
1095822604;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;25
1005370218;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;27
1098795821;SANTANDER;BUCARAMANGA;SENA - CSET - COLISEO;CRA 27 # 15-07 BARRIO SAN FRANCISCO;13
1001672961;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;3
1005280232;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;7
1005234243;SANTANDER;BUCARAMANGA;COL COOPERATIVO DE BUCARAMANGA;CLL 45 # 0-160 BARRIO CAMPO HERMOSO;23
1095953752;SANTANDER;GIRON;COLEGIO DIANA TURBAY;CLL 105 NO 9-40 MALPASO;14
1098634260;BOGOTA D.C.;BOGOTA. D.C.;UNIVERSIDAD KONRAD LORENZ;CRA 9 BIS # 62 - 43;25
1095946631;SANTANDER;GIRON;COLEGIO MARIO MORALES DELGADO;VIA ZAPATOCA;12
1000973507;SANTANDER;BUCARAMANGA;IE ANDRES PAEZ DE SOTOMAYOR;CLL 37 # 1-97 BARRIO LA JOYA;12
1098613238;SANTANDER;BUCARAMANGA;IE ANDRES PAEZ DE SOTOMAYOR;CLL 37 # 1-97 BARRIO LA JOYA;15
1004913293;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;3
1095300047;SANTANDER;BUCARAMANGA;COL COOPERATIVO DE BUCARAMANGA;CLL 45 # 0-160 BARRIO CAMPO HERMOSO;25
1001890273;SANTANDER;BUCARAMANGA;IE BICENTENARIO SEDE B;CLL 34 # 45 - 38 BARRIO ALVAREZ;2
1005328040;SANTANDER;BUCARAMANGA;IE DÁMASO ZAPATA SEDE C;CLL 16N # 24-23 BARRIO VILLA HELENA;3
1081788029;SANTANDER;BUCARAMANGA;COL COOPERATIVO DE BUCARAMANGA;CLL 45 # 0-160 BARRIO CAMPO HERMOSO;24
1000938935;SANTANDER;BUCARAMANGA;IE PROVENZA;CR 23 # 109 - 07 BARRIO PROVENZA;11
1098765665;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;40
1005330639;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;22
1098770037;SANTANDER;BUCARAMANGA;COL SANTANDER SEDE A;CLL 9 # 25-67 BARRIO LA UNIVERSIDAD;40
1098803709;SANTANDER;BUCARAMANGA;IE CENTRO PILOTO SIMON BOLIVAR;CR 20 # 11-83 - BARRIO MUTUALIDAD;21
1234338821;SANTANDER;BUCARAMANGA;UNIDADES TECNOLOGICAS DE SANT;AV LOS ESTUDIANTES # 9-82 BARRIO REAL DE MINAS;37
1005323333;SANTANDER;BUCARAMANGA;IE NUESTRA SEÑORA DEL PILAR SEDE A;AV LOS ESTUDIANTES # 9-323 BARRIO REAL DE MINAS;15
1099734584;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;34
1005325058;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;4
1005162125;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;25
1098799697;SANTANDER;BUCARAMANGA;I.E. JOSE CELESTINO MUTIS;CR 3W # 57 - 14 BARRIO MUITS;43
1002971881;SANTANDER;BUCARAMANGA;GIMNASIO SUPERIOR EMPRESARIAL;CLL 67 # 11-29 BARRIO LA VICTORIA;3
1098770859;SANTANDER;BUCARAMANGA;COL AURELIO MARTINEZ MUTIS SEDE B;CLL 56 # 21-52 BARRIO LA CONCORDIA;9
1098815278;SANTANDER;BUCARAMANGA;COL SANTANDER SEDE C;CLL 5 # 20-14 BARRIO COMUNEROS;6
1098807648;SANTANDER;BUCARAMANGA;COL PSICOPEDAG CARL ROGERS;CR 25 # 31 - 94 BARRIO ANTONIA SANTOS;14
1095825522;SANTANDER;FLORIDABLANCA;INSTITUTO DOMINGO SABIO;CALLE 14 No. 13-20 VILLABEL;14
1098818161;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;8
1051670242;SANTANDER;BUCARAMANGA;COOP ESPECIALIZ DE EDUC DE COMFENALCO;CLL 37 #21-34 PARQUE BOLIVAR;17
1098648554;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;27
1095834718;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;43
1098691076;SANTANDER;BUCARAMANGA;IE TEC RAFAEL GARCIA HERREROS;CR 1D # N-81 - BARRIO MINUTO DE DIOS;19
1005110246;SANTANDER;BUCARAMANGA;INST CALDAS;CIRCUNV 35 # 92 - 135 BARRIO TEJAR MODERNO;26
1005136357;SANTANDER;BUCARAMANGA;COL COOPERATIVO DE BUCARAMANGA;CLL 45 # 0-160 BARRIO CAMPO HERMOSO;23
1098708059;SANTANDER;BUCARAMANGA;COL. INTEGRADO JORGE ISAAC;CLL 106 No 29-47 BARRIO DIAMANTE I;5
79273264;SANTANDER;BUCARAMANGA;INST CALDAS;CIRCUNV 35 # 92 - 135 BARRIO TEJAR MODERNO;17
1018224841;SANTANDER;BUCARAMANGA;ESC NORMAL SUPERIOR SEDE A;CLL 30 # 27-163 BARRIO AURORA;42
1098821511;SANTANDER;BUCARAMANGA;UNIDADES TECNOLOGICAS DE SANT;AV LOS ESTUDIANTES # 9-82 BARRIO REAL DE MINAS;34
1098797426;SANTANDER;BUCARAMANGA;INST DE PROM SOC DEL NORTE SEDE A;CR 22B # 1-61 BARRIO SAN CRISTOBAL;26
1005281523;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;26
1005327380;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;27
1005564368;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;39
1018513742;SANTANDER;FLORIDABLANCA;POLIDEPORTIVO JOSE ELIAS PUYANA;CALLE 4 No. 11- 37 CASCO URBANO;9
1098748794;SANTANDER;BUCARAMANGA;LA CAPILLA;ESC RURAL LA CAPILLA;4
1005236732;SANTANDER;BUCARAMANGA;I.E. LA JUVENTUD SEDE A;CLL 5 N # 19 A - 12 BARRIO LA JUVENTUD;3
1232891482;SANTANDER;BUCARAMANGA;INST DE PROM SOC DEL NORTE SEDE A;CR 22B # 1-61 BARRIO SAN CRISTOBAL;30
1005257591;SANTANDER;BUCARAMANGA;COL AURELIO MARTINEZ MUTIS SEDE A;AV LOS ESTUDIANTES # 9-313 BARRIO REAL DE MINAS;13
1098810060;SANTANDER;BUCARAMANGA;ESC NORMAL SUPERIOR SEDE A;CLL 30 # 27-163 BARRIO AURORA;49
1005161532;SANTANDER;BUCARAMANGA;EFORSALUD;CLL 48 # 27 - 64 BARRIO SOTOMAYOR;7
1005337220;SANTANDER;BUCARAMANGA;INST CALDAS;CIRCUNV 35 # 92 - 135 BARRIO TEJAR MODERNO;24
1005464892;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;22
1113979006;SANTANDER;BUCARAMANGA;GOBERNACION DE SANTANDER;CLL 37 No 10-36 BARRIO GARCIA ROVIRA;23
1113979007;SANTANDER;BUCARAMANGA;IE DÁMASO ZAPATA SEDE C;CLL 16N # 24-23 BARRIO VILLA HELENA;6
1095836326;SANTANDER;FLORIDABLANCA;COLEGIO JOSE ELIAS PUYANA SEDE B;CALLE 5 No. 14 -15 ALTAMIRA;17
1005012410;SANTANDER;BUCARAMANGA;COL COOPERATIVO DE BUCARAMANGA;CLL 45 # 0-160 BARRIO CAMPO HERMOSO;22
1098816304;SANTANDER;BUCARAMANGA;GIMNASIO CAMPESTRE SAN SEBASTIAN;CRA 53 N 73 83 BARRIO LAGOS DEL CACIQUE;8
1095831006;SANTANDER;BUCARAMANGA;COL AMERICANO;CR 18 # 19-22 BARRIO SAN FRANCISCO;7
1104255664;SANTANDER;BUCARAMANGA;COL ADVENTISTA LIBERTAD;CR 15 # 103D - 160 BARRIO DELICIAS ALTAS;40
1012317720;SANTANDER;PUENTE NACIONAL;PUESTO CABECERA MUNICIPAL;INT TECNICO INDUSTRIAL FRANCIS;23
1193239373;SANTANDER;BUCARAMANGA;COL ADVENTISTA LIBERTAD;CR 15 # 103D - 160 BARRIO DELICIAS ALTAS;41
1098775188;SANTANDER;BUCARAMANGA;I.E. JOSE CELESTINO MUTIS;CR 3W # 57 - 14 BARRIO MUITS;42
1007735149;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE E;CLL 91 # 25 - 82 BARRIO DIAMANTE II;20
1007596684;SANTANDER;BUCARAMANGA;I.E. LA JUVENTUD SEDE A;CLL 5 N # 19 A - 12 BARRIO LA JUVENTUD;6
1232891171;SANTANDER;BUCARAMANGA;IE CAFÉ MADRID;CR 8B # 35AN-45 BARRIO CAFÉ MADRID;31
1232891100;SANTANDER;BUCARAMANGA;CENTRO VIDA KENNEDY;CRA 12 # 16N - 43 BARRIO KENNEDY;15
1005334932;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;39
1096239788;SANTANDER;BUCARAMANGA;UNIDADES TECNOLOGICAS DE SANT;AV LOS ESTUDIANTES # 9-82 BARRIO REAL DE MINAS;27
1098803735;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;40
1007732385;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;28
1005161673;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;25
1005325402;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE E;CLL 91 # 25 - 82 BARRIO DIAMANTE II;20
1098791030;SANTANDER;BUCARAMANGA;I.E. LAS AMERICAS;CLL 33 # 36 - 16 BARRIO ALVAREZ;27
1127352555;SANTANDER;BUCARAMANGA;IE INEM SEDE D;CRA 15 No 107 63 BARRIO DANGOND;2
1098745670;SANTANDER;BUCARAMANGA;IE COMUNEROS;CR 18 # 10-20 BARRIO COMUNEROS;25
1098810731;SANTANDER;BUCARAMANGA;COL AURELIO MARTINEZ MUTIS SEDE B;CLL 56 # 21-52 BARRIO LA CONCORDIA;10
1098774798;SANTANDER;BUCARAMANGA;I. INTEGRADO JORGE ELIECER GAITAN SEDE A;CLL 16 # 9-54 BARRIO GAITAN;12
1005185976;SANTANDER;BUCARAMANGA;COL DE LAS AMERICAS;CLL 51 # 24 - 20 BARRIO NUEVO SOTOMAYOR;10
1098820612;SANTANDER;BUCARAMANGA;I.E. LAS AMERICAS;CLL 33 # 36 - 16 BARRIO ALVAREZ;28
1098790372;SANTANDER;BUCARAMANGA;COL DE LAS AMERICAS;CLL 51 # 24 - 20 BARRIO NUEVO SOTOMAYOR;15
1003823441;SANTANDER;BUCARAMANGA;COL SANTANDER SEDE C;CLL 5 # 20-14 BARRIO COMUNEROS;2
1025525218;SANTANDER;BUCARAMANGA;UNIDADES TECNOLOGICAS DE SANT;AV LOS ESTUDIANTES # 9-82 BARRIO REAL DE MINAS;24
1005323036;SANTANDER;BUCARAMANGA;COL DE LAS AMERICAS;CLL 51 # 24 - 20 BARRIO NUEVO SOTOMAYOR;10
1098783833;SANTANDER;BUCARAMANGA;GIMNASIO CAMPESTRE SAN SEBASTIAN;CRA 53 N 73 83 BARRIO LAGOS DEL CACIQUE;7
1005186696;SANTANDER;BUCARAMANGA;GOBERNACION DE SANTANDER;CLL 37 No 10-36 BARRIO GARCIA ROVIRA;19
1095830645;SANTANDER;BUCARAMANGA;INST CALDAS;CIRCUNV 35 # 92 - 135 BARRIO TEJAR MODERNO;26
1032499215;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;40
1095824317;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;42
1098823186;SANTANDER;BUCARAMANGA;COL ADVENTISTA LIBERTAD;CR 15 # 103D - 160 BARRIO DELICIAS ALTAS;40
1005326492;SANTANDER;BUCARAMANGA;COL FRANCISCANO DEL VIRREY SOL;CLL 18 # 22-29 BARRIO SAN FRANCISCO;22
1232892316;SANTANDER;BUCARAMANGA;ORDEN DE LOS CLÉRIGOS REG SOMASCOS;CR 26 # 11N-30 BARRIO REGADERO NORTE;25
1095580227;SANTANDER;BUCARAMANGA;ORDEN DE LOS CLÉRIGOS REG SOMASCOS;CR 26 # 11N-30 BARRIO REGADERO NORTE;14
1095580534;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;4
1098802126;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE B;CLL 26 # 2-11 BARRIO LA FERIA;7
1193221510;SANTANDER;BUCARAMANGA;COL AURELIO MARTINEZ MUTIS SEDE A;AV LOS ESTUDIANTES # 9-313 BARRIO REAL DE MINAS;17
1098777682;SANTANDER;BUCARAMANGA;COL FRANCISCO DE PAULA S/DER SEDE A;CR 5 OCC # 30-61 BARRIO SANTANDER;8
1005106530;SANTANDER;FLORIDABLANCA;COLEGIO ISIDRO CABALLERO SEDE B;CALLE 117 No. 33-00 LA CASTELLANA;10
1007540294;SANTANDER;BUCARAMANGA;IE BICENTENARIO SEDE B;CLL 34 # 45 - 38 BARRIO ALVAREZ;4
1005110090;SANTANDER;BUCARAMANGA;IE CAMPO HERMOSO;CR 9A OCC # 49-24 BARRIO CAMPO HERMOSO;3
13748312;SANTANDER;BUCARAMANGA;IE INEM CUSTODIO GARCIA ROV SEDE A;CR 19A # 104 - 56 BARRIO PROVENZA;5
1098826714;SANTANDER;BUCARAMANGA;UNIVERSIDAD COOP DE COLOMBIA;CLL 30A # 33 - 51 BARRIO QUINTADANIA;39
1005260913;SANTANDER;BUCARAMANGA;COL SANTANDER SEDE A;CLL 9 # 25-67 BARRIO LA UNIVERSIDAD;35
1005161134;SANTANDER;BUCARAMANGA;INST TEC SALESIANO ELOY VALENZ;AV QUEBRADA SECA # 11-85 BARRIO GIRARDOT;25
1232891745;SANTANDER;BUCARAMANGA;INST DE PROM SOC DEL NORTE SEDE A;CR 22B # 1-61 BARRIO SAN CRISTOBAL;30
1005573546;SANTANDER;BUCARAMANGA;I.E. JOSE CELESTINO MUTIS;CR 3W # 57 - 14 BARRIO MUITS;32
1005161279;SANTANDER;GIRON;COLEGIO DIANA TURBAY;CLL 105 NO 9-40 MALPASO;10
1098814874;SANTANDER;BUCARAMANGA;I.E. LA JUVENTUD SEDE A;CLL 5 N # 19 A - 12 BARRIO LA JUVENTUD;7
1098787824;SANTANDER;BUCARAMANGA;I.E. LA JUVENTUD SEDE A;CLL 5 N # 19 A - 12 BARRIO LA JUVENTUD;7
1005321528;SANTANDER;BUCARAMANGA;IE CAMPO HERMOSO;CR 9A OCC # 49-24 BARRIO CAMPO HERMOSO;3
1096182562;SANTANDER;BUCARAMANGA;I.E. LAS AMERICAS;CLL 33 # 36 - 16 BARRIO ALVAREZ;23
1002211612;SANTANDER;BUCARAMANGA;I.E. JOSE CELESTINO MUTIS;CR 3W # 57 - 14 BARRIO MUITS;30
1005210384;SANTANDER;BUCARAMANGA;CORP UNIVERSITARIA UNICIENCIA;CLL 37 # 11 - 58 BARRIO EL CENTRO;22
1005323342;SANTANDER;BUCARAMANGA;COOP ESPECIALIZ DE EDUC DE COMFENALCO;CLL 37 #21-34 PARQUE BOLIVAR;16
1001820939;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;19
1135254070;SANTANDER;BUCARAMANGA;I.E. LAS AMERICAS;CLL 33 # 36 - 16 BARRIO ALVAREZ;29
1005237878;SANTANDER;FLORIDABLANCA;COLEGIO JOSE ELIAS PUYANA SEDE A;CALLE 4 No. 11- 79 CASCO URBANO;22
1098698436;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;32
1005325088;SANTANDER;BUCARAMANGA;IE MAIPORÉ SEDE B;CLL 17N # 10-38 BARRIO KENNEDY;22
1095580073;SANTANDER;BUCARAMANGA;COL SANTANDER SEDE C;CLL 5 # 20-14 BARRIO COMUNEROS;4
1065603614;SANTANDER;BUCARAMANGA;COL COOPERATIVO DE BUCARAMANGA;CLL 45 # 0-160 BARRIO CAMPO HERMOSO;24
1098799599;SANTANDER;BUCARAMANGA;COL AURELIO MARTINEZ MUTIS SEDE B;CLL 56 # 21-52 BARRIO LA CONCORDIA;10
1095298171;SANTANDER;BUCARAMANGA;SALON COMUNAL EL PABLON;CR 11 # 61N-10 BARRIO EL PABLON;2
1005261104;SANTANDER;BUCARAMANGA;IE PROVENZA;CR 23 # 109 - 07 BARRIO PROVENZA;13
1005848706;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;22
1010005735;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;23
1005259156;SANTANDER;BUCARAMANGA;UNIDADES TECNOLOGICAS DE SANT;AV LOS ESTUDIANTES # 9-82 BARRIO REAL DE MINAS;20
1098070903;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;27
1096700645;SANTANDER;BUCARAMANGA;ESC NORMAL SUPERIOR SEDE A;CLL 30 # 27-163 BARRIO AURORA;44
1098797687;SANTANDER;BUCARAMANGA;ESC NORMAL SUPERIOR SEDE A;CLL 30 # 27-163 BARRIO AURORA;48
1007439669;SANTANDER;BUCARAMANGA;UNIVERSIDAD COOP DE COLOMBIA;CLL 30A # 33 - 51 BARRIO QUINTADANIA;29
1005450885;SANTANDER;BUCARAMANGA;UNIVERSIDAD INDUSTRIAL DE SANTANDER;CLL 9 CON CRA 27;22
1002726475;SANTANDER;BUCARAMANGA;SENA - CSET - COLISEO;CRA 27 # 15-07 BARRIO SAN FRANCISCO;8
1098621062;SANTANDER;BUCARAMANGA;IE CENTRO PILOTO SIMON BOLIVAR;CR 20 # 11-83 - BARRIO MUTUALIDAD;20
1098612128;SANTANDER;BUCARAMANGA;SALON COMUNAL EL PABLON;CR 11 # 61N-10 BARRIO EL PABLON;2
1097781550;SANTANDER;BUCARAMANGA;IE SANTA MARIA GORETTI SEDE C;CLL 65 OCC # 18 - 08 BARRIO LA VICTORIA;1
1098804312;SANTANDER;BUCARAMANGA;COL NUESTRA SEÑORA DE FATIMA;CR 12 # 41 - 69 BARRIO EL CENTRO;13'''

VOTANTES_ERROR = """1007596684;ERROR;No se encuentra en el censo electoral para las elecciones de Autoridades Territoriales 2023.;;;;
1093295357;ERROR;No se encuentra en el censo electoral para las elecciones de Autoridades Territoriales 2023.;;;;"""


class Command(BaseCommand):
    def handle(self, *args, **options):
        votantes = VOTANTES.split('\n')

        for votante_line in votantes:
            votante = votante_line.split(';')
            try:
                document_id = votante[0]
                if document_id and document_id.isdigit():
                    print('checking get votante {}'.format(document_id))
                    departamento = votante[1]
                    municipio = votante[2]
                    name = votante[3]
                    address = votante[4]
                    mesa = votante[5]

                    departamento_obj = Departamento.objects.filter(name=departamento).first()
                    if not departamento_obj:
                        print('creating departamento {}'.format(departamento))
                        departamento_obj = Departamento()
                        departamento_obj.name = departamento
                        departamento_obj.save()

                    municipio_obj = Municipio.objects.filter(name=municipio, departamento__name=departamento).first()
                    if not municipio_obj:
                        print('creating municipio {}'.format(municipio))
                        municipio_obj = Municipio()
                        municipio_obj.name = municipio
                        municipio_obj.departamento = departamento_obj
                        municipio_obj.save()
                    
                    print('get votante{}'.format(document_id))
                    v = Votante.objects.filter(document_id=document_id).first()
                    if not v:
                        print('creating votante {}'.format(document_id))
                        v = Votante()
                        v.document_id = document_id
                        v.status = "PENDING"
                        v.save()


                    pv = PuestoVotacion.objects.filter(name=name, address=address).first()
                    if not pv:
                        print('creating puesto votacion {}'.format(name))

                        pv = PuestoVotacion()
                        pv.departamento = departamento_obj
                        pv.municipio = municipio_obj
                        pv.name = name
                        pv.address = address
                        pv.save()

                    vpv = VotantePuestoVotacion.objects.filter(votante=v, puesto_votacion=pv).filter()
                    if not vpv:
                        print('creating puesto votacion {}, votante'.format(pv.name, v.document_id))

                        vpv = VotantePuestoVotacion()
                        vpv.votante = v
                        vpv.puesto_votacion = pv
                        vpv.mesa = mesa
                        vpv.save()
                        v.status = "PROCESSED"
                        v.save()
                    else:
                        v.status = "PROCESSED"
                        v.save()


            except Exception as e:
                print('error ', e)

        if VOTANTES_ERROR:
            votantes = VOTANTES_ERROR.split('\n')

            for votante_line in votantes:
                votante = votante_line.split(',')
                document_id = votante[0]
                message = votante[2]

                v = Votante.objects.filter(document_id=document_id).first()
                if not v:
                    print('creating votante {}'.format(document_id))
                    v = Votante()
                    v.document_id = document_id

                v.status = "ERROR"
                v.save()

                vm = VotanteMessage.objects.filter(votante=v).first()
                if not v:
                    vm = VotanteMessage()
                    vm.votante=v
                    vm.message=message
                    vm.save()